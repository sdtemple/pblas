xb = beta * 2
plot.new()
plot.window(c(xa, xb), c(ya, yb))
axis(1)
axis(2)
title(xlab = expression(gamma))
title(ylab = "Density")
box()
lines(density(y[6,], from = 0), col = acol[2], lwd = 2)
lines(density(y[4,], from = 0), col = acol[1], lwd = 2) # std over
lines(density(y[8,], from = 0), col = acol[3], lwd = 2)
abline(v = gamma)
}
set.seed(5132021)
# epidemic
N = 200
A = 10
beta = 1.5
gamma = 1
# initialize
ct = 0
K = 2000
U = 50
storage = array(NA, dim = c(8,K))
# run
while(ct < K){
epi = rgsem(beta, gamma, N)
r = (epi[,2])[is.finite(epi[,2])]
r = sort(r)
while(length(r) < A){
epi = rgsem(beta, gamma, N)
r = (epi[,2])[is.finite(epi[,2])]
r = sort(r)
}
ct = ct + 1
storage[1,ct] = length(r)
storage[2,ct] = N
storage[3:4,ct] = nlm(pbla_homo, c(1,1), pbla=pbla_std_homo, r=r, N=N)$estimate
storage[5:6,ct] = nlm(pbla_homo, c(1,1), pbla=pbla_prod, r=r, N=N)$estimate
storage[7:8,ct] = nlm(pbla_homo, c(1,1), pbla=pbla_weak, r=r, N=N)$estimate
if(!(ct %% U)){
print(ct)
}
}
getwd()
# saving
saveRDS(storage, "../scripts/pbla-nN.rds")
deciles = N * seq(.1, 1, by=.1)
deciles[10] = deciles[10] + 1
# all eight
par(mfrow=c(4,2))
for(i in 1:8){
# subset by deciles
x = (storage[1,] >= deciles[i]) & (storage[1,] < deciles[i+1])
y = storage[,x]
print(dim(y)[2])
# betas
yb = max(density(y[3,], from = 0)$y,
density(y[5,], from = 0)$y,
density(y[7,], from = 0)$y) + 0.1
xb = beta * 2
plot.new()
plot.window(c(xa, xb), c(ya, yb))
axis(1)
axis(2)
title(main=paste('Percent Infected:', round(deciles[i] / N, 2), '-', round(deciles[i+1] / N, 2)))
title(xlab = expression(beta))
title(ylab = "Density")
box()
lines(density(y[5,], from = 0), col = acol[2], lwd = 2)
lines(density(y[3,], from = 0), col = acol[1], lwd = 2) # std over
lines(density(y[7,], from = 0), col = acol[3], lwd = 2)
abline(v = beta)
if((i %in% c(1,5))){
legend("topright",
c("Std","Prod","Weak"),
col = acol[1:3],
lwd = rep(2,3))
}
# gammas
yb = max(density(y[4,], from = 0)$y,
density(y[6,], from = 0)$y,
density(y[8,], from = 0)$y) + 0.1
xb = beta * 2
plot.new()
plot.window(c(xa, xb), c(ya, yb))
axis(1)
axis(2)
title(xlab = expression(gamma))
title(ylab = "Density")
box()
lines(density(y[6,], from = 0), col = acol[2], lwd = 2)
lines(density(y[4,], from = 0), col = acol[1], lwd = 2) # std over
lines(density(y[8,], from = 0), col = acol[3], lwd = 2)
abline(v = gamma)
}
par(mfrow=c(4,2))
for(i in 3:6){
# subset by deciles
x = (storage[1,] >= deciles[i]) & (storage[1,] < deciles[i+1])
y = storage[,x]
# betas
yb = max(density(y[3,], from = 0)$y,
density(y[5,], from = 0)$y,
density(y[7,], from = 0)$y) + 0.1
xb = beta * 2
plot.new()
plot.window(c(xa, xb), c(ya, yb))
axis(1)
axis(2)
title(main=paste('Percent Infected:', round(deciles[i] / N, 2), '-', round(deciles[i+1] / N, 2)))
title(xlab = expression(beta))
title(ylab = "Density")
box()
lines(density(y[5,], from = 0), col = acol[2], lwd = 2)
lines(density(y[3,], from = 0), col = acol[1], lwd = 2) # std over
lines(density(y[7,], from = 0), col = acol[3], lwd = 2)
abline(v = beta)
if(i == 3){
legend("topright",
c("Std","Prod","Weak"),
col = acol[1:3],
lwd = rep(2,3))
}
# gammas
yb = max(density(y[4,], from = 0)$y,
density(y[6,], from = 0)$y,
density(y[8,], from = 0)$y) + 0.1
xb = beta * 2
plot.new()
plot.window(c(xa, xb), c(ya, yb))
axis(1)
axis(2)
title(xlab = expression(gamma))
title(ylab = "Density")
box()
lines(density(y[6,], from = 0), col = acol[2], lwd = 2)
lines(density(y[4,], from = 0), col = acol[1], lwd = 2) # std over
lines(density(y[8,], from = 0), col = acol[3], lwd = 2)
abline(v = gamma)
}
for(i in 1:8){
# subset by deciles
x = (storage[1,] >= deciles[i]) & (storage[1,] < deciles[i+1])
y = storage[,x]
print(dim(y)[2])
# betas
yb = max(density(y[3,], from = 0)$y,
density(y[5,], from = 0)$y,
density(y[7,], from = 0)$y) + 0.1
xb = beta * 2
plot.new()
plot.window(c(xa, xb), c(ya, yb))
axis(1)
axis(2)
title(main=paste('Percent Infected:', round(deciles[i] / N, 2), '-', round(deciles[i+1] / N, 2)))
title(xlab = expression(beta))
title(ylab = "Density")
box()
lines(density(y[5,], from = 0), col = acol[2], lwd = 2)
lines(density(y[3,], from = 0), col = acol[1], lwd = 2) # std over
lines(density(y[7,], from = 0), col = acol[3], lwd = 2)
abline(v = beta)
if((i %in% c(1,5))){
legend("topright",
c("Std","Prod","Weak"),
col = acol[1:3],
lwd = rep(2,3))
}
# gammas
yb = max(density(y[4,], from = 0)$y,
density(y[6,], from = 0)$y,
density(y[8,], from = 0)$y) + 0.1
xb = beta * 2
plot.new()
plot.window(c(xa, xb), c(ya, yb))
axis(1)
axis(2)
title(xlab = expression(gamma))
title(ylab = "Density")
box()
lines(density(y[6,], from = 0), col = acol[2], lwd = 2)
lines(density(y[4,], from = 0), col = acol[1], lwd = 2) # std over
lines(density(y[8,], from = 0), col = acol[3], lwd = 2)
abline(v = gamma)
}
par(mfrow=c(4,2))
for(i in 3:6){
# subset by deciles
x = (storage[1,] >= deciles[i]) & (storage[1,] < deciles[i+1])
y = storage[,x]
# betas
yb = max(density(y[3,], from = 0)$y,
density(y[5,], from = 0)$y,
density(y[7,], from = 0)$y) + 0.1
xb = beta * 2
plot.new()
plot.window(c(xa, xb), c(ya, yb))
axis(1)
axis(2)
title(main=paste('Percent Infected:', round(deciles[i] / N, 2), '-', round(deciles[i+1] / N, 2)))
title(xlab = expression(beta))
title(ylab = "Density")
box()
lines(density(y[5,], from = 0), col = acol[2], lwd = 2)
lines(density(y[3,], from = 0), col = acol[1], lwd = 2) # std over
lines(density(y[7,], from = 0), col = acol[3], lwd = 2)
abline(v = beta)
if(i == 3){
legend("topright",
c("Std","Prod","Weak"),
col = acol[1:3],
lwd = rep(2,3))
}
# gammas
yb = max(density(y[4,], from = 0)$y,
density(y[6,], from = 0)$y,
density(y[8,], from = 0)$y) + 0.1
xb = beta * 2
plot.new()
plot.window(c(xa, xb), c(ya, yb))
axis(1)
axis(2)
title(xlab = expression(gamma))
title(ylab = "Density")
box()
lines(density(y[6,], from = 0), col = acol[2], lwd = 2)
lines(density(y[4,], from = 0), col = acol[1], lwd = 2) # std over
lines(density(y[8,], from = 0), col = acol[3], lwd = 2)
abline(v = gamma)
}
for(i in 4:7){
# subset by deciles
x = (storage[1,] >= deciles[i]) & (storage[1,] < deciles[i+1])
y = storage[,x]
# betas
yb = max(density(y[3,], from = 0)$y,
density(y[5,], from = 0)$y,
density(y[7,], from = 0)$y) + 0.1
xb = beta * 2
plot.new()
plot.window(c(xa, xb), c(ya, yb))
axis(1)
axis(2)
title(main=paste('Percent Infected:', round(deciles[i] / N, 2), '-', round(deciles[i+1] / N, 2)))
title(xlab = expression(beta))
title(ylab = "Density")
box()
lines(density(y[5,], from = 0), col = acol[2], lwd = 2)
lines(density(y[3,], from = 0), col = acol[1], lwd = 2) # std over
lines(density(y[7,], from = 0), col = acol[3], lwd = 2)
abline(v = beta)
if(i == 4){
legend("topright",
c("Std","Prod","Weak"),
col = acol[1:3],
lwd = rep(2,3))
}
# gammas
yb = max(density(y[4,], from = 0)$y,
density(y[6,], from = 0)$y,
density(y[8,], from = 0)$y) + 0.1
xb = beta * 2
plot.new()
plot.window(c(xa, xb), c(ya, yb))
axis(1)
axis(2)
title(xlab = expression(gamma))
title(ylab = "Density")
box()
lines(density(y[6,], from = 0), col = acol[2], lwd = 2)
lines(density(y[4,], from = 0), col = acol[1], lwd = 2) # std over
lines(density(y[8,], from = 0), col = acol[3], lwd = 2)
abline(v = gamma)
}
par(mfrow=c(4,2))
for(i in 4:7){
# subset by deciles
x = (storage[1,] >= deciles[i]) & (storage[1,] < deciles[i+1])
y = storage[,x]
# R0
yb = max(density(y[3,]/y[4,], from = 0)$y,
density(y[5,]/y[6,], from = 0)$y,
density(y[7,]/y[6,], from = 0)$y) + 0.1
xb = beta / gamma * 2
plot.new()
plot.window(c(xa, xb), c(ya, yb))
axis(1)
axis(2)
title(main=paste('Percent Infected:', round(deciles[i] / N, 2), '-', round(deciles[i+1] / N, 2)))
title(xlab = expression("R"[0]))
title(ylab = "Density")
box()
lines(density(y[5,]/y[6,], from = 0), col = acol[2], lwd = 2)
lines(density(y[3,]/y[4,], from = 0), col = acol[1], lwd = 2) # std over
lines(density(y[7,]/y[8,], from = 0), col = acol[3], lwd = 2)
abline(v = beta)
if(i == 4){
legend("topright",
c("Std","Prod","Weak"),
col = acol[1:3],
lwd = rep(2,3))
}
}
par(mfrow=c(4,1))
for(i in 4:7){
# subset by deciles
x = (storage[1,] >= deciles[i]) & (storage[1,] < deciles[i+1])
y = storage[,x]
# R0
yb = max(density(y[3,]/y[4,], from = 0)$y,
density(y[5,]/y[6,], from = 0)$y,
density(y[7,]/y[6,], from = 0)$y) + 0.1
xb = beta / gamma * 2
plot.new()
plot.window(c(xa, xb), c(ya, yb))
axis(1)
axis(2)
title(main=paste('Percent Infected:', round(deciles[i] / N, 2), '-', round(deciles[i+1] / N, 2)))
title(xlab = expression("R"[0]))
title(ylab = "Density")
box()
lines(density(y[5,]/y[6,], from = 0), col = acol[2], lwd = 2)
lines(density(y[3,]/y[4,], from = 0), col = acol[1], lwd = 2) # std over
lines(density(y[7,]/y[8,], from = 0), col = acol[3], lwd = 2)
abline(v = beta)
if(i == 4){
legend("topright",
c("Std","Prod","Weak"),
col = acol[1:3],
lwd = rep(2,3))
}
}
par(mfrow=c(4,2))
xa = 1
for(i in 1:8){
# subset by deciles
x = (storage[1,] >= deciles[i]) & (storage[1,] < deciles[i+1])
y = storage[,x]
# R0
yb = max(density(y[3,]/y[4,], from = 0)$y,
density(y[5,]/y[6,], from = 0)$y,
density(y[7,]/y[6,], from = 0)$y) + 0.1
xb = beta / gamma * 1.5
plot.new()
plot.window(c(xa, xb), c(ya, yb))
axis(1)
axis(2)
title(main=paste('Percent Infected:', round(deciles[i] / N, 2), '-', round(deciles[i+1] / N, 2)))
title(xlab = expression("R"[0]))
title(ylab = "Density")
box()
lines(density(y[5,]/y[6,], from = 0), col = acol[2], lwd = 2)
lines(density(y[3,]/y[4,], from = 0), col = acol[1], lwd = 2) # std over
lines(density(y[7,]/y[8,], from = 0), col = acol[3], lwd = 2)
abline(v = beta)
if(i == 4){
legend("topright",
c("Std","Prod","Weak"),
col = acol[1:3],
lwd = rep(2,3))
}
}
xa = 1
par(mfrow=c(4,2))
for(i in 1:8){
# subset by deciles
x = (storage[1,] >= deciles[i]) & (storage[1,] < deciles[i+1])
y = storage[,x]
# R0
yb = max(density(y[3,]/y[4,], from = 0)$y,
density(y[5,]/y[6,], from = 0)$y,
density(y[7,]/y[6,], from = 0)$y) + 0.1
xb = beta / gamma * 1.5
plot.new()
plot.window(c(xa, xb), c(ya, yb))
axis(1)
axis(2)
title(main=paste('Percent Infected:', round(deciles[i] / N, 2), '-', round(deciles[i+1] / N, 2)))
title(xlab = expression("R"[0]))
title(ylab = "Density")
box()
lines(density(y[5,]/y[6,], from = 0), col = acol[2], lwd = 2)
lines(density(y[3,]/y[4,], from = 0), col = acol[1], lwd = 2) # std over
lines(density(y[7,]/y[8,], from = 0), col = acol[3], lwd = 2)
abline(v = beta)
if(i == 1){
legend("topright",
c("Std","Prod","Weak"),
col = acol[1:3],
lwd = rep(2,3))
}
}
xa = 1
par(mfrow=c(3,2))
for(i in 1:6){
# subset by deciles
x = (storage[1,] >= deciles[i]) & (storage[1,] < deciles[i+1])
y = storage[,x]
# R0
yb = max(density(y[3,]/y[4,], from = 0)$y,
density(y[5,]/y[6,], from = 0)$y,
density(y[7,]/y[6,], from = 0)$y) + 0.1
xb = beta / gamma * 1.5
plot.new()
plot.window(c(xa, xb), c(ya, yb))
axis(1)
axis(2)
title(main=paste('Percent Infected:', round(deciles[i] / N, 2), '-', round(deciles[i+1] / N, 2)))
title(xlab = expression("R"[0]))
title(ylab = "Density")
box()
lines(density(y[5,]/y[6,], from = 0), col = acol[2], lwd = 2)
lines(density(y[3,]/y[4,], from = 0), col = acol[1], lwd = 2) # std over
lines(density(y[7,]/y[8,], from = 0), col = acol[3], lwd = 2)
abline(v = beta)
if(i == 1){
legend("topright",
c("Std","Prod","Weak"),
col = acol[1:3],
lwd = rep(2,3))
}
}
xa = 1
par(mfrow=c(3,2))
for(i in 2:7){
# subset by deciles
x = (storage[1,] >= deciles[i]) & (storage[1,] < deciles[i+1])
y = storage[,x]
# R0
yb = max(density(y[3,]/y[4,], from = 0)$y,
density(y[5,]/y[6,], from = 0)$y,
density(y[7,]/y[6,], from = 0)$y) + 0.1
xb = beta / gamma * 1.5
plot.new()
plot.window(c(xa, xb), c(ya, yb))
axis(1)
axis(2)
title(main=paste('Percent Infected:', round(deciles[i] / N, 2), '-', round(deciles[i+1] / N, 2)))
title(xlab = expression("R"[0]))
title(ylab = "Density")
box()
lines(density(y[5,]/y[6,], from = 0), col = acol[2], lwd = 2)
lines(density(y[3,]/y[4,], from = 0), col = acol[1], lwd = 2) # std over
lines(density(y[7,]/y[8,], from = 0), col = acol[3], lwd = 2)
abline(v = beta)
if(i == 1){
legend("topright",
c("Std","Prod","Weak"),
col = acol[1:3],
lwd = rep(2,3))
}
}
xa = 1
par(mfrow=c(2,2))
for(i in 3:6){
# subset by deciles
x = (storage[1,] >= deciles[i]) & (storage[1,] < deciles[i+1])
y = storage[,x]
# R0
yb = max(density(y[3,]/y[4,], from = 0)$y,
density(y[5,]/y[6,], from = 0)$y,
density(y[7,]/y[6,], from = 0)$y) + 0.1
xb = beta / gamma * 1.5
plot.new()
plot.window(c(xa, xb), c(ya, yb))
axis(1)
axis(2)
title(main=paste('Percent Infected:', round(deciles[i] / N, 2), '-', round(deciles[i+1] / N, 2)))
title(xlab = expression("R"[0]))
title(ylab = "Density")
box()
lines(density(y[5,]/y[6,], from = 0), col = acol[2], lwd = 2)
lines(density(y[3,]/y[4,], from = 0), col = acol[1], lwd = 2) # std over
lines(density(y[7,]/y[8,], from = 0), col = acol[3], lwd = 2)
abline(v = beta)
if(i == 1){
legend("topright",
c("Std","Prod","Weak"),
col = acol[1:3],
lwd = rep(2,3))
}
}
par(mfrow=c(2,2))
for(i in 3:6){
# subset by deciles
x = (storage[1,] >= deciles[i]) & (storage[1,] < deciles[i+1])
y = storage[,x]
# R0
yb = max(density(y[3,]/y[4,], from = 0)$y,
density(y[5,]/y[6,], from = 0)$y,
density(y[7,]/y[6,], from = 0)$y) + 0.1
xb = beta / gamma * 1.5
plot.new()
plot.window(c(xa, xb), c(ya, yb))
axis(1)
axis(2)
title(main=paste('Percent Infected:', round(deciles[i] / N, 2), '-', round(deciles[i+1] / N, 2)))
title(xlab = expression("R"[0]))
title(ylab = "Density")
box()
lines(density(y[5,]/y[6,], from = 0), col = acol[2], lwd = 2)
lines(density(y[3,]/y[4,], from = 0), col = acol[1], lwd = 2) # std over
lines(density(y[7,]/y[8,], from = 0), col = acol[3], lwd = 2)
abline(v = beta)
if(i == 3){
legend("topright",
c("Std","Prod","Weak"),
col = acol[1:3],
lwd = rep(2,3))
}
}
